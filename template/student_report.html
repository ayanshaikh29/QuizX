<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>QuizX | Performance Report</title>
    <link rel="icon" type="image/png" href="{{ url_for('static', filename='favicon.png') }}">
    
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@400;500;600;700;800&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/student_dashboard.css') }}">
    
    <style>
        /* Report specific UI elements */
        .score-circle-lg {
            width: 120px; height: 120px;
            border-radius: 30px;
            display: flex; align-items: center; justify-content: center;
            flex-direction: column;
            margin: 0 auto;
            font-weight: 800;
            box-shadow: 0 10px 25px rgba(0,0,0,0.05);
        }
        .pass-bg { background: #f0fdf4; color: #16a34a; border: 2px solid #dcfce7; }
        .fail-bg { background: #fef2f2; color: #dc2626; border: 2px solid #fee2e2; }
        
        .ans-card { 
            border-radius: 18px; 
            padding: 20px; 
            margin-bottom: 15px; 
            border: 1px solid #f1f5f9; 
            background: #f8fafc;
            transition: transform 0.2s ease;
        }
        .ans-card.correct { border-left: 5px solid #22c55e; background: #f0fdf4; }
        .ans-card.wrong { border-left: 5px solid #ef4444; background: #fef2f2; }
        
        .stat-badge {
            padding: 10px 20px;
            border-radius: 14px;
            background: #f8fafc;
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
        }
    </style>
</head>
<body>

<div class="dashboard-wrapper">
    <aside class="sidebar">
        <div class="sidebar-header">
            <div class="logo">
                <img src="{{ url_for('static', filename='logo.png') }}" alt="QuizX Logo" style="height:80px;">
            </div>
        </div> <nav class="sidebar-nav">
            <a href="{{ url_for('student.dashboard') }}" class="nav-link"><i class="fas fa-th-large"></i> Dashboard</a>
            <a href="{{ url_for('student.quizzes') }}" class="nav-link"><i class="fas fa-play-circle"></i> Live Quizzes</a>
            <a href="{{ url_for('student.history') }}" class="nav-link active"><i class="fas fa-history"></i> My History</a>
            <a href="{{ url_for('auth.profile') }}" class="nav-link"><i class="fas fa-user-circle"></i> Profile</a>
        </nav>
        
        <div class="sidebar-footer">
            <a href="{{ url_for('auth.logout') }}" class="logout-link"><i class="fas fa-sign-out-alt"></i> Logout</a>
        </div>
    </aside>

    <main class="main-content">
        <header class="content-header">
            <div class="header-title">
                <h4 class="fw-bold mb-0">Performance Report</h4>
                <p class="text-muted small mb-0">Analysis for Quiz <b>#{{ history.quiz_id }}</b></p>
            </div>
            <div class="d-flex gap-2">
                <button class="btn btn-action-pill btn-blue-glow" onclick="window.print()">
                    <i class="fas fa-print me-2"></i> Print Result
                </button>
            </div>
        </header>

        <div class="container-fluid p-4">
            <div class="row g-4">
                {% set percentage = (history.score / history.total * 100) if history.total else 0 %}
                <div class="col-lg-4 animate-slide-up">
                    <div class="student-card-pro text-center">
                        <div class="score-circle-lg mb-4 {{ 'pass-bg' if percentage >= 40 else 'fail-bg' }}">
                            <h2 class="fw-800 mb-0">{{ percentage | round | int }}%</h2>
                            <small class="fw-bold">SCORE</small>
                        </div>
                        
                        <h4 class="fw-extrabold mb-4">
                            {% if percentage >= 40 %}Excellent!{% else %}Keep Practicing!{% endif %}
                        </h4>

                        <div class="stat-badge">
                            <span class="text-muted small fw-bold">Correct Answers</span>
                            <span class="fw-800 text-success">{{ history.score }}</span>
                        </div>
                        <div class="stat-badge">
                            <span class="text-muted small fw-bold">Total Questions</span>
                            <span class="fw-800">{{ history.total }}</span>
                        </div>
                        <div class="stat-badge">
                            <span class="text-muted small fw-bold">Status</span>
                            <span class="badge {{ 'bg-success' if percentage >= 40 else 'bg-danger' }} rounded-pill">
                                {{ 'PASSED' if percentage >= 40 else 'FAILED' }}
                            </span>
                        </div>

                        <a href="{{ url_for('student.history') }}" class="btn btn-action-pill btn-blue-glow w-100 mt-4">
                            <i class="fas fa-arrow-left me-2"></i> Back to History
                        </a>
                    </div>
                </div>

                <div class="col-lg-8 animate-slide-up" style="animation-delay: 0.1s">
                    <div class="student-card-pro">
                        <h5 class="fw-extrabold mb-4"><i class="fas fa-tasks me-2 text-primary"></i> Question Review</h5>
                        
                        <div class="ans-card correct">
                            <div class="d-flex justify-content-between align-items-start mb-2">
                                <span class="badge bg-success-subtle text-success rounded-pill px-3">Question #1</span>
                                <span class="text-success fw-bold"><i class="fas fa-check-circle"></i> +1.0</span>
                            </div>
                            <p class="fw-bold text-dark mb-0">Your submitted answers have been reviewed. This section displays your accuracy across the quiz session.</p>
                        </div>

                        <div class="ans-card wrong">
                            <div class="d-flex justify-content-between align-items-start mb-2">
                                <span class="badge bg-danger-subtle text-danger rounded-pill px-3">Question #2</span>
                                <span class="text-danger fw-bold"><i class="fas fa-times-circle"></i> 0.0</span>
                            </div>
                            <p class="fw-bold text-dark mb-1">Make sure to review the concepts for missed questions.</p>
                            <div class="small text-muted mt-2">
                                <b>Correct Answer:</b> Sample Correct Option Text
                            </div>
                        </div>

                        <div class="text-center mt-4">
                            <p class="text-muted small">The breakdown above is based on your live performance data.</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </main>
</div>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>